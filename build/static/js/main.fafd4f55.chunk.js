(this.webpackJsonpcodebreak=this.webpackJsonpcodebreak||[]).push([[0],{39:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var s,n=a(1),i=a.n(n),r=a(13),c=a.n(r),o=(a(39),a(14)),l=a(15),d=a(7),h=a(20),m=a(19),g=a(8);a(45),a(46);!function(e){e[e.InProgress=1]="InProgress",e[e.Won=2]="Won",e[e.Lost=3]="Lost"}(s||(s={}));var p=a(25),u=a.n(p),_=a(31),j=(a(48),a(49),a(0));var b=function(e){var t=[];return 2===e.game_status&&t.push(Object(j.jsxs)("div",{className:"Fireworks",children:[Object(j.jsx)("div",{className:"FireworksBefore"},"1"),Object(j.jsx)("div",{className:"FireworksAfter"},"2")]},"0")),Object(j.jsx)("div",{className:"FireworksContainer",children:t})};a(51);var O=function(e){return Object(j.jsx)("div",{className:"Status "+["","StatusGameInProgress","StatusGameWon","StatusGameLost"][e.game_status],children:["","Game in progress","Game won","Game lost"][e.game_status]})};a(52);var f=function(e){for(var t=[],a=i.a.useRef(null),s=0;s<e.max_attempts;s++){var n=[],r=[];n.push(Object(j.jsxs)("td",{className:"historyAttemptId",children:["#",s+1]},s+"_-1"));for(var c=0;c<e.code_length;c++){var o="".concat(s,"_").concat(c);e.history.length>s?n.push(Object(j.jsx)("td",{children:Object(j.jsx)("span",{className:"codeColor"+e.history[s][c]})},o)):n.push(Object(j.jsx)("td",{children:Object(j.jsx)("span",{className:"noColor"})},o))}var l=e.indicators_history[s],d=e.code_length;if(l){d=e.code_length-l.fullMatches-l.partialMatches;for(var h=0;h<l.fullMatches;h++)r.push(Object(j.jsx)("div",{className:"indicator indicator_green"},"indicator_green_"+s+"_"+h));for(var m=0;m<l.partialMatches;m++)r.push(Object(j.jsx)("div",{className:"indicator indicator_white"},"indicator_white_"+s+"_"+m))}for(var g=0;g<d;g++)r.push(Object(j.jsx)("div",{className:"indicator"},"indicator_"+s+"_"+g));n.push(Object(j.jsx)("td",{className:"td_indicators",children:r},"indicator_"+s)),0===s?t.push(Object(j.jsx)("tr",{ref:a,children:n},s)):t.push(Object(j.jsx)("tr",{children:n},s))}return i.a.useEffect((function(){0===e.history.length&&a.current&&a.current.scrollIntoView(),window.scrollTo({top:0,left:0})})),t.reverse(),Object(j.jsx)("div",{className:"History",children:Object(j.jsx)("table",{children:Object(j.jsx)("tbody",{children:t})})})},x=a(29),v=a(62),S=a(63),y=a(28),N=a(33);a(53);function C(e){e.itemType;var t=e.item,a=e.style,s="DropItem DropItemPreview codeColor"+t.i.toString();return Object(j.jsx)("div",{className:s,style:a,children:t.i})}function I(e){var t=Object(v.a)((function(){return{type:"DropItem",item:function(){return console.log("drop start"),e.board_ref.current&&e.board_ref.current.classList.add("dragInProgress"),{i:e.i}},collect:function(e){return{opacity:e.isDragging()?.6:1}},end:function(t,a){console.log("drop end"),e.board_ref.current&&e.board_ref.current.classList.remove("dragInProgress")}}}),[e.i,"some value"]),a=Object(x.a)(t,2),s=a[0].opacity,n=a[1],i="DropItem codeColor".concat(e.i),r={opacity:s};return Object(j.jsx)("div",{ref:n,style:r,id:"dropItem"+e.i,className:i,children:e.i})}function G(e){var t=Object(S.a)({accept:"DropItem",drop:function(t){e.setDropTargetColor(e.i,t.i)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop(),item:e.getItem()}}}),a=Object(x.a)(t,2),s=a[0],n=(s.canDrop,s.isOver),i=(s.item,a[1]),r="DropTargetColorDisplay";return e.color_id?r+=" codeColor".concat(e.color_id):r+=" noColor",n&&(r+=" DropTargetHover"),Object(j.jsx)("div",{className:"DropTarget",ref:i,children:Object(j.jsx)("div",{className:r})})}var k=function(e){for(var t=[],a=0;a<e.game_settings.code_length;a++)t.push(Object(j.jsx)(G,{i:a,color_id:e.current_drop_area_state[a],board_ref:e.board_ref,setDropTargetColor:e.setDropTargetColor},a));for(var s=[],n=1;n<=e.game_settings.number_of_colors;n++)s.push(Object(j.jsx)(I,{i:n,board_ref:e.board_ref},n));var i="dropItems";return e.game_settings.number_of_colors>=7&&(i+=" dropItems4Columns"),Object(j.jsxs)("div",{className:"DropArea",children:[Object(j.jsxs)(y.a,{options:N.a,children:[Object(j.jsx)(y.b,{generator:C}),Object(j.jsxs)("div",{className:"dropTargets",children:[Object(j.jsx)("p",{children:"Drag and drop colors here:"}),Object(j.jsxs)("div",{className:"dropTargetsGroup",children:[t,Object(j.jsx)("div",{className:"clearAttempt",children:Object(j.jsx)("button",{onClick:function(){return e.clearAttempt()},title:"Clear an attempt",children:Object(j.jsx)("i",{className:"fas fa-trash-alt"})})})]})]}),Object(j.jsx)("div",{className:i,children:s})]}),Object(j.jsx)("div",{className:"addAttempt",children:Object(j.jsx)("button",{disabled:!e.is_drop_area_filled,onClick:function(){return e.addAttemptToHistory()},title:"Add an attempt",children:Object(j.jsx)("i",{className:"fas fa-plus"})})}),Object(j.jsx)("div",{className:"restartGame",children:Object(j.jsxs)("button",{onClick:function(){return Object(g.b)("/")},title:"Start a new game",children:[" ",Object(j.jsx)("i",{className:"fas fa-home"})]})}),Object(j.jsx)("div",{className:"showHelp",children:Object(j.jsxs)("button",{onClick:function(){return e.changeHelpVisibility(!0)},title:"Show help",children:[" ",Object(j.jsx)("i",{className:"fas fa-question"})]})})]})};a(54);var w=function(e){var t=[];return e.is_help_shown&&t.push(Object(j.jsxs)("div",{className:"Help",children:[Object(j.jsx)("button",{title:"Close",className:"closeHelpButton",onClick:function(){return e.changeHelpVisibility(!1)},children:Object(j.jsx)("i",{className:"fas fa-times"})}),Object(j.jsx)("h2",{children:"Help"}),Object(j.jsx)("p",{children:"Drag colors from the bottom panel and drop them in the drop area."}),Object(j.jsx)("p",{children:'When all colors are added, click the button "Add\xa0attempt":'}),Object(j.jsx)("img",{src:"/help/add_attempt.png",alt:"Add attempt button",className:"helpAddAttemptImage"}),Object(j.jsxs)("div",{className:"helpImageContainer",children:[Object(j.jsx)("img",{src:"/help/white_indicators.png",alt:"White indicators",className:"helpIndicatorsImage"}),Object(j.jsx)("span",{children:"White circles indicate correct colors, but in the wrong place."})]}),Object(j.jsxs)("div",{className:"helpImageContainer",children:[Object(j.jsx)("img",{src:"/help/green_indicators.png",alt:"Green indicators",className:"helpIndicatorsImage"}),Object(j.jsx)("span",{children:"Green circles indicate correct colors in the right place."})]}),Object(j.jsx)("p",{children:"Your goal is to break the code in the smallest number of attempts."})]},1)),Object(j.jsx)("div",{className:"HelpContainer",children:t})},H=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).board_ref=i.a.createRef(),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(_.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.target_code_exists){e.next=5;break}return e.next=3,Object(g.b)("/");case 3:return e.next=5,Object(g.b)("/");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(j.jsxs)("div",{className:"Board",ref:this.board_ref,children:[Object(j.jsx)(w,{is_help_shown:this.props.is_help_shown,changeHelpVisibility:this.props.changeHelpVisibility}),Object(j.jsx)(b,{game_status:this.props.game_status}),Object(j.jsxs)("div",{className:"HistoryContainer",children:[Object(j.jsx)(O,{game_status:this.props.game_status}),Object(j.jsx)(f,{history:this.props.history,indicators_history:this.props.indicators_history,max_attempts:this.props.game_settings.max_attempts,code_length:this.props.game_settings.code_length})]}),Object(j.jsx)(k,{current_drop_area_state:this.props.current_drop_area_state,game_settings:this.props.game_settings,board_ref:this.board_ref,is_drop_area_filled:this.props.is_drop_area_filled,addAttemptToHistory:this.props.addAttemptToHistory,changeHelpVisibility:this.props.changeHelpVisibility,clearAttempt:this.props.clearAttempt,setDropTargetColor:this.props.setDropTargetColor})]})}}]),a}(i.a.Component);a(55);var A=function(e){return Object(j.jsxs)("div",{className:"GameSettings",children:[Object(j.jsx)("h2",{children:"Code Break"}),Object(j.jsx)("h3",{children:"Game settings"}),Object(j.jsx)("span",{className:"gameSettingsGroupHeader",children:"Max attempts:"}),Object(j.jsxs)("div",{className:"gameSettingsGroup",children:[Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_ma_6",name:"max_attempts",value:"6",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_ma_6",children:"6"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_ma_8",name:"max_attempts",value:"8",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_ma_8",children:"8"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_ma_10",name:"max_attempts",value:"10",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_ma_10",children:"10"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_ma_12",name:"max_attempts",value:"12",onChange:function(t){return e.handleGameSettingsChange(t)},defaultChecked:!0}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_ma_12",children:"12"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_ma_14",name:"max_attempts",value:"14",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_ma_14",children:"14"})]})]}),Object(j.jsx)("span",{className:"gameSettingsGroupHeader",children:"Number of colours:"}),Object(j.jsxs)("div",{className:"gameSettingsGroup",children:[Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_noc_4",name:"number_of_colors",value:"4",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_noc_4",children:"4"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_noc_5",name:"number_of_colors",value:"5",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_noc_5",children:"5"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_noc_6",name:"number_of_colors",value:"6",onChange:function(t){return e.handleGameSettingsChange(t)},defaultChecked:!0}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_noc_6",children:"6"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_noc_7",name:"number_of_colors",value:"7",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_noc_7",children:"7"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_noc_8",name:"number_of_colors",value:"8",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_noc_8",children:"8"})]})]}),Object(j.jsx)("span",{className:"gameSettingsGroupHeader",children:"Code length:"}),Object(j.jsxs)("div",{className:"gameSettingsGroup",children:[Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_cl_3",name:"code_length",value:"3",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_cl_3",children:"3"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_cl_4",name:"code_length",value:"4",onChange:function(t){return e.handleGameSettingsChange(t)},defaultChecked:!0}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_cl_4",children:"4"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption hiddenOnMobile",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_cl_5",name:"code_length",value:"5",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_cl_5",children:"5"})]}),Object(j.jsxs)("div",{className:"gameSettingsOption hiddenOnMobile",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_cl_6",name:"code_length",value:"6",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_cl_6",children:"6"})]})]}),Object(j.jsx)("span",{className:"gameSettingsGroupHeader",children:"Possibility of repeating colours:"}),Object(j.jsxs)("div",{className:"gameSettingsGroup",children:[Object(j.jsxs)("div",{className:"gameSettingsOption gameSettingsOptionLarge",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_crcic_true",name:"can_repeat_colors_in_code",value:"true",onChange:function(t){return e.handleGameSettingsChange(t)}}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_crcic_true",children:Object(j.jsxs)("span",{children:[Object(j.jsx)("i",{className:"fas fa-check"})," YES"]})})]}),Object(j.jsxs)("div",{className:"gameSettingsOption gameSettingsOptionLarge",children:[Object(j.jsx)("input",{type:"radio",className:"gameSettingsInput",id:"gameSettingsInput_crcic_false",name:"can_repeat_colors_in_code",value:"false",onChange:function(t){return e.handleGameSettingsChange(t)},defaultChecked:!0}),Object(j.jsx)("label",{htmlFor:"gameSettingsInput_crcic_false",children:Object(j.jsxs)("span",{children:[Object(j.jsx)("i",{className:"fas fa-times"})," NO"]})})]})]}),Object(j.jsxs)("button",{id:"startGameButton",onClick:function(){return e.startGame()},children:["Start ",Object(j.jsx)("i",{className:"fas fa-angle-double-right"})]}),Object(j.jsx)("footer",{children:"\xa9 2021 Code Break \u2013 Teodor"})]})},T=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={game_settings:{max_attempts:0,code_length:0,number_of_colors:0,can_repeat_colors_in_code:!1,first_init_happened:!1},game_status:s.InProgress,target_code:[],history:[],indicators_history:[],current_drop_area_state:[],is_drop_area_filled:!1,is_help_shown:!1},n.handleGameSettingsChange=n.handleGameSettingsChange.bind(Object(d.a)(n)),n.startGame=n.startGame.bind(Object(d.a)(n)),n.addAttemptToHistory=n.addAttemptToHistory.bind(Object(d.a)(n)),n.changeHelpVisibility=n.changeHelpVisibility.bind(Object(d.a)(n)),n.clearAttempt=n.clearAttempt.bind(Object(d.a)(n)),n.setDropTargetColor=n.setDropTargetColor.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=Object.assign({},this.state.game_settings);t.first_init_happened||(t.max_attempts=12,t.code_length=4,t.number_of_colors=6,t.can_repeat_colors_in_code=!1,t.first_init_happened=!0,this.setState({game_settings:t})),window.addEventListener("keydown",(function(t){"Escape"==t.code&&e.changeHelpVisibility(!1)}))}},{key:"getTargetCode",value:function(e,t,a){var s,n,i=[],r=a;t<e&&(r=!0);do{var c=(s=1,n=t,Math.floor(Math.random()*(n-s+1)+s));!r&&i.includes(c)||i.push(c)}while(i.length<e);return i}},{key:"handleGameSettingsChange",value:function(e){var t,a=Object.assign({},this.state.game_settings),s=e.target;switch(s.name){case"max_attempts":t=parseInt(s.value),a.max_attempts=t;break;case"code_length":t=parseInt(s.value),a.code_length=t;break;case"number_of_colors":t=parseInt(s.value),a.number_of_colors=t;break;case"can_repeat_colors_in_code":t="true"==s.value,a.can_repeat_colors_in_code=t}this.setState({game_settings:a})}},{key:"changeHelpVisibility",value:function(e){e?this.setState({is_help_shown:!0}):this.setState({is_help_shown:!1})}},{key:"startGame",value:function(){var e=this.state.game_settings,t=this.getTargetCode(e.code_length,e.number_of_colors,e.can_repeat_colors_in_code);this.setState({game_status:s.InProgress,target_code:t,history:[],indicators_history:[],current_drop_area_state:[],is_drop_area_filled:!1}),Object(g.b)("/board")}},{key:"setDropTargetColor",value:function(e,t){var a,s,n=this.state.current_drop_area_state.slice();n[e]=t,this.setState({current_drop_area_state:n,is_drop_area_filled:(a=n,s=this.state.game_settings.code_length,!(a.length&&s-a.reduce((function(e,t){return e+(t?1:0)}),0)))})}},{key:"addAttemptToHistory",value:function(){var e=this;if(this.state.game_status==s.InProgress&&this.state.is_drop_area_filled&&this.state.history.length<this.state.game_settings.max_attempts){var t=this.state.history.slice();t.push(this.state.current_drop_area_state);var a=this.calculateIndicators(this.state.current_drop_area_state,this.state.target_code),n=this.state.indicators_history.slice();n.push(a);var i=this.state.current_drop_area_state.join(""),r=this.state.target_code.join("");this.setState({history:t,indicators_history:n},(function(){i===r?e.setState({game_status:s.Won,is_drop_area_filled:!1}):e.state.history.length==e.state.game_settings.max_attempts&&e.setState({game_status:s.Lost,is_drop_area_filled:!1})}))}}},{key:"clearAttempt",value:function(){this.setState({current_drop_area_state:[],is_drop_area_filled:!1})}},{key:"calculateIndicators",value:function(e,t){var a=0,s=0,n=new Array(this.state.game_settings.number_of_colors+1).fill(0),i=new Array(this.state.game_settings.number_of_colors+1).fill(0);return e.forEach((function(e){n[e]++})),t.forEach((function(e){i[e]++})),n.forEach((function(e,t){a+=Math.min(n[t],i[t])})),e.forEach((function(e,a){e===t[a]&&s++})),{partialMatches:a-=s,fullMatches:s}}},{key:"render",value:function(){return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)("header",{className:"App-header",children:"Code Break"}),Object(j.jsxs)(g.a,{children:[Object(j.jsx)(A,{path:"/",handleGameSettingsChange:this.handleGameSettingsChange,startGame:this.startGame}),Object(j.jsx)(H,{path:"board",current_drop_area_state:this.state.current_drop_area_state,game_status:this.state.game_status,game_settings:this.state.game_settings,history:this.state.history,indicators_history:this.state.indicators_history,is_drop_area_filled:this.state.is_drop_area_filled,target_code_exists:!!this.state.target_code.length,is_help_shown:this.state.is_help_shown,addAttemptToHistory:this.addAttemptToHistory,changeHelpVisibility:this.changeHelpVisibility,clearAttempt:this.clearAttempt,setDropTargetColor:this.setDropTargetColor})]})]})}}]),a}(i.a.Component),D=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,64)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,i=t.getLCP,r=t.getTTFB;a(e),s(e),n(e),i(e),r(e)}))};c.a.render(Object(j.jsx)(i.a.StrictMode,{children:Object(j.jsx)(T,{})}),document.getElementById("root")),D()}},[[56,1,2]]]);
//# sourceMappingURL=main.fafd4f55.chunk.js.map